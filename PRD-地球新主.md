# 产品需求文档 (PRD)
## 地球新主 (Earth Lord)

**版本:** 1.0
**更新日期:** 2025-12-24
**产品负责人:** [待填写]
**文档状态:** 草案

---

## 1. 产品概述

### 1.1 产品定位
地球新主是一款基于真实地理位置的末日生存策略游戏，结合了"Walk to Earn"、LBS探索、资源管理和社交互动等核心玩法。玩家通过在现实世界中行走来圈占领地、探索废墟、收集资源、建造家园，并与其他幸存者进行交易和社交。

### 1.2 目标用户
- **核心用户:** 18-35岁热爱运动、喜欢探索和收集类游戏的移动游戏玩家
- **次要用户:** 希望通过游戏化方式增加运动量的健康生活追求者
- **潜在用户:** 喜欢末日题材、生存模拟类游戏的玩家群体

### 1.3 核心价值主张
- **运动激励:** 将现实世界的行走转化为游戏内收益，鼓励用户增加运动量
- **真实地理融合:** 基于真实POI的探索系统，让玩家重新发现身边的世界
- **社交互动:** 基于位置的交易和通讯系统，促进同城玩家互动
- **策略深度:** 资源管理、建造规划、生存体征等多维度策略玩法

### 1.4 商业模式
- **订阅制:** 月卡会员($9.99/月)、领主通行证($19.99/月)
- **内购道具:** 资源包($0.99-$9.99)、特殊装备
- **未来扩展:** 广告收入、品牌合作、线下活动

---

## 2. 市场分析

### 2.1 市场机会
- LBS游戏市场持续增长,宝可梦GO累计收入超60亿美元
- 健康和健身类应用市场规模持续扩大(Keep估值超百亿)
- 生存类游戏持续受欢迎(《饥荒》《方舟》等)

### 2.2 竞争分析
| 竞品 | 优势 | 劣势 | 差异化策略 |
|------|------|------|-----------|
| 宝可梦GO | 品牌影响力强、用户基数大 | 玩法单一、社交性弱 | 更深度的策略系统+生存机制 |
| Keep | 专业运动指导 | 游戏性不足 | 游戏化运动体验 |
| Ingress | 成熟的LBS玩法 | 门槛高、新手不友好 | 简化操作+末日题材 |

### 2.3 市场定位
中度策略+轻度运动的LBS游戏，填补"有深度的运动游戏"市场空白

---

## 3. 产品功能需求

### 3.1 核心功能架构

```
┌─────────────────────────────────────────────────────────┐
│                      产品功能架构                          │
├─────────────────────────────────────────────────────────┤
│                                                         │
│   ┌──────────┐    ┌──────────┐    ┌──────────┐       │
│   │用户系统    │    │地图系统    │    │探索系统    │       │
│   │- 登录注册  │    │- GPS圈地   │    │- POI发现   │       │
│   │- 个人档案  │    │- 领地管理  │    │- 资源搜刮  │       │
│   └──────────┘    └──────────┘    └──────────┘       │
│                                                         │
│   ┌──────────┐    ┌──────────┐    ┌──────────┐       │
│   │资源系统    │    │建造系统    │    │交易系统    │       │
│   │- 背包管理  │    │- 建筑放置  │    │- 玩家交易  │       │
│   │- 物品分类  │    │- 状态管理  │    │- 挂单匹配  │       │
│   └──────────┘    └──────────┘    └──────────┘       │
│                                                         │
│   ┌──────────┐    ┌──────────┐    ┌──────────┐       │
│   │通讯系统    │    │社交系统    │    │商业化系统  │       │
│   │- 消息中心  │    │- 排行榜    │    │- 内购支付  │       │
│   │- 公共频道  │    │- 成就系统  │    │- 订阅管理  │       │
│   │- PTT呼叫   │    │- 生存体征  │    │- 多语言    │       │
│   └──────────┘    └──────────┘    └──────────┘       │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 3.2 功能优先级矩阵

#### P0 (必须有 - MVP)
1. **用户系统**
   - 邮箱/Apple/Google登录
   - 用户档案基础信息
   - 会话管理

2. **地图系统**
   - GPS定位
   - 圈地功能(绘制多边形)
   - 领地基础信息展示

3. **探索系统**
   - POI识别和发现
   - 基础资源搜刮
   - 背包系统

4. **建造系统**
   - 基础建筑(篝火、庇护所)
   - 资源消耗验证
   - 建筑状态管理

#### P1 (应该有 - 第一次迭代)
1. **交易系统**
   - 玩家间物品交易
   - 交易挂单系统

2. **通讯系统**
   - 公共频道聊天
   - 消息推送

3. **社交系统**
   - 排行榜(领地/探索/建筑)
   - 基础成就系统

#### P2 (可以有 - 后续迭代)
1. **高级通讯**
   - 频道系统
   - PTT呼叫
   - 设备等级

2. **生存体征**
   - 饱食度/水分系统
   - 时间衰减机制

3. **商业化功能**
   - 内购系统
   - 订阅管理
   - 多语言支持

---

## 4. 详细功能说明

### 4.1 用户系统

#### 4.1.1 登录注册
**功能描述:**
支持三种登录方式,为用户提供便捷的身份认证。

**需求细节:**
- 邮箱注册:用户名+密码,需要邮箱验证
- Apple登录:使用Sign in with Apple,一键登录
- Google登录:OAuth2.0认证流程

**验收标准:**
- [ ] 三种登录方式均可正常工作
- [ ] 登录成功后正确跳转到主界面
- [ ] 会话保持,下次打开自动登录
- [ ] 登出功能正常

**技术实现:**
- 使用Supabase Auth
- 实现AuthManager统一管理认证状态
- 安全存储token

#### 4.1.2 个人档案
**功能描述:**
展示玩家的游戏数据和成就。

**需求细节:**
- 基础信息:幸存者等级、存活天数
- 领地统计:领地数量、总面积
- 建筑统计:建筑数量、类型分布
- 探索数据:探索距离、搜刮次数

**验收标准:**
- [ ] 数据实时同步
- [ ] 统计数据准确
- [ ] UI展示清晰美观

### 4.2 地图系统

#### 4.2.1 GPS圈地
**功能描述:**
玩家通过在现实世界中行走,用GPS轨迹圈占领地。

**需求细节:**
1. 开始圈地:点击按钮开始记录GPS轨迹
2. 轨迹绘制:实时在地图上显示蓝色轨迹线
3. 自动闭合:当玩家回到起点附近(50米内),轨迹自动闭合
4. 验证规则:
   - 最小面积:1000平方米
   - 最大面积:50000平方米
   - 不与其他玩家领地重叠
   - 轨迹点间隔合理(防止作弊)
5. 领地确认:通过验证后,多边形变绿,领地归属玩家

**验收标准:**
- [ ] GPS定位精度在10米以内
- [ ] 轨迹绘制流畅,无明显延迟
- [ ] 闭合判断准确
- [ ] 作弊检测生效(快速移动、跳跃式移动等)
- [ ] 重叠检测准确

**技术实现:**
- 使用iOS MapKit
- LocationManager管理GPS定位
- PostGIS存储多边形数据
- ST_Intersects检测重叠

#### 4.2.2 领地管理
**功能描述:**
管理已拥有的领地,包括命名、设置、查看详情。

**需求细节:**
- 领地列表:显示所有拥有的领地
- 领地详情:名称、面积、建筑数量、位置
- 领地设置:
  - 允许/禁止交易
  - 领地重命名
  - 领地删除(需确认)
- 领地状态:活跃度(基于最后访问时间)

**验收标准:**
- [ ] 领地数据准确显示
- [ ] 设置修改实时生效
- [ ] 删除操作有二次确认

### 4.3 探索系统

#### 4.3.1 POI发现
**功能描述:**
玩家在现实世界移动时,自动发现附近的兴趣点(餐厅、医院、公园等)。

**需求细节:**
1. 自动检测:玩家进入POI 100米范围内触发
2. 提示弹窗:显示POI名称和类型
3. POI类型:
   - 餐厅/超市 → 食物资源
   - 医院/药店 → 药品资源
   - 工厂/工地 → 金属资源
   - 公园/林地 → 木材资源
   - 银行/珠宝店 → 稀有资源
4. 冷却机制:同一POI每24小时只能搜刮一次

**验收标准:**
- [ ] 地理围栏触发准确
- [ ] POI数据准确(使用Apple MapKit数据)
- [ ] 冷却时间正确计算
- [ ] 已搜刮POI有明确标识

**技术实现:**
- MapKit POI搜索
- 地理围栏(Geofencing)
- 本地存储已搜刮记录

#### 4.3.2 资源搜刮
**功能描述:**
在发现的POI处搜刮资源。

**需求细节:**
1. 搜刮过程:点击"搜刮"按钮,显示加载动画(2-3秒)
2. 奖励计算:
   - 基础掉落:根据POI类型
   - 距离加成:行走距离越远,奖励越多
   - 时长加成:探索时长越长,奖励越多
   - 随机浮动:±20%
3. 结果展示:
   - 探索距离
   - 探索时长
   - 获得物品列表
4. 自动存入背包

**验收标准:**
- [ ] 奖励计算公式准确
- [ ] 物品正确添加到背包
- [ ] 动画和反馈流畅

#### 4.3.3 背包系统
**功能描述:**
存储和管理收集到的资源。

**需求细节:**
- 容量限制:初始100格,可通过建造仓库扩容
- 物品分类:
  - 食物(罐头、水等)
  - 药品(急救包、抗生素等)
  - 材料(木材、石头、金属等)
  - 稀有(卫星模块、电路板等)
- 物品操作:
  - 使用(食物、药品)
  - 丢弃(确认)
  - 交易(发起交易)
- 筛选排序:按类型、数量、稀有度

**验收标准:**
- [ ] 容量计算准确
- [ ] 物品使用效果正确
- [ ] 筛选排序功能正常
- [ ] 数据持久化

**技术实现:**
- 本地优先架构(SwiftData)
- 云端同步(Supabase)
- 离线可用

### 4.4 建造系统

#### 4.4.1 建筑类型
**功能描述:**
在领地上建造各类建筑。

**建筑清单:**

**Tier 1 - 生存基础**
| 建筑名称 | 所需资源 | 功能 |
|---------|---------|------|
| 篝火 | 石头×20, 木材×30 | 提供温暖,小范围照明 |
| 简易庇护所 | 木材×50, 布料×10 | 基础休息点 |
| 小型仓库 | 木材×40, 石头×20 | 增加背包容量+20 |

**Tier 2 - 功能扩展**
| 建筑名称 | 所需资源 | 功能 |
|---------|---------|------|
| 中型仓库 | 木材×80, 石头×60, 金属×20 | 增加背包容量+50 |
| 简易工作台 | 木材×60, 金属×30 | 可制作简单工具 |
| 雨水收集器 | 塑料×30, 金属×20 | 自动生产水 |
| 小农田 | 木材×50, 肥料×20 | 生产食物 |

**Tier 3 - 高级设施**
| 建筑名称 | 所需资源 | 功能 |
|---------|---------|------|
| 太阳能板 | 金属×100, 电路板×50 | 提供电力 |
| 风力发电机 | 金属×150, 电路板×80 | 提供电力(高效) |
| 净水装置 | 金属×120, 过滤器×50 | 生产饮用水 |

#### 4.4.2 建造流程
**需求细节:**
1. 选择建筑:从建造菜单选择
2. 资源检查:验证背包中是否有足够资源
3. 位置选择:在领地内拖动建筑图标选择位置
4. 开始建造:
   - 立即扣除资源
   - 建筑进入"建造中"状态
   - 建造时间:Tier1(即时), Tier2(1小时), Tier3(3小时)
5. 建造完成:自动转为"待激活"状态

**验收标准:**
- [ ] 资源检查准确
- [ ] 建筑只能放置在自己的领地内
- [ ] 建筑不能重叠
- [ ] 建造倒计时准确
- [ ] 状态转换正确

#### 4.4.3 建筑状态机
**状态流转:**
```
规划中 → 建造中 → 待激活 → 运行中 → 损坏 → 维修中 → 运行中
                                    ↓
                                  已拆除
```

**状态说明:**
- **规划中:** 已选择但未确认位置
- **建造中:** 正在建造,有倒计时
- **待激活:** 建造完成,等待玩家激活
- **运行中:** 正常工作,提供功能
- **损坏:** 需要维修(消耗原材料的50%)
- **维修中:** 正在维修,有倒计时
- **已拆除:** 回收50%原材料

**验收标准:**
- [ ] 状态转换逻辑正确
- [ ] 不同状态下可执行操作正确
- [ ] 状态持久化

### 4.5 交易系统

#### 4.5.1 交易机制
**功能描述:**
玩家间基于位置的物品交易系统。

**需求细节:**
1. 发布挂单:
   - 选择"我提供"的物品和数量
   - 选择"我需要"的物品和数量
   - 发布后在交易市场展示
2. 发现交易:
   - 只能看到100米范围内的交易
   - 且对方领地设置了"允许交易"
3. 接受交易:
   - 验证双方资源是否足够
   - 原子性交换(要么都成功,要么都失败)
   - 交易记录保存
4. 取消挂单:
   - 只能取消自己的挂单
   - 物品返还

**验收标准:**
- [ ] 距离判断准确
- [ ] 交易权限检查正确
- [ ] 交易过程原子性
- [ ] 资源扣除和增加准确
- [ ] 交易历史可查询

**技术实现:**
- 数据库事务保证原子性
- PostGIS距离查询
- 实时推送交易状态

### 4.6 通讯系统

#### 4.6.1 消息中心
**功能描述:**
系统消息和通知的集中展示。

**消息类型:**
- 官方公告:游戏更新、活动通知
- 生存指南:新手教程、玩法提示
- 每日任务:每日更新的任务列表
- 交易通知:交易成功/失败通知
- 系统通知:账号安全、违规警告

**验收标准:**
- [ ] 消息分类清晰
- [ ] 未读消息有标识
- [ ] 推送及时(1分钟内)

#### 4.6.2 公共频道
**功能描述:**
基于位置的公共聊天室。

**需求细节:**
- 覆盖范围:3公里
- 消息展示:
  - 发送者昵称
  - 距离显示(如"1.2km")
  - 消息内容
  - 发送时间
- 实时更新:新消息自动推送
- 消息限制:
  - 长度限制:500字符
  - 频率限制:10秒/条(防刷屏)
  - 内容审核:敏感词过滤

**验收标准:**
- [ ] 距离计算准确
- [ ] 消息实时到达(1秒内)
- [ ] 频率限制生效
- [ ] 敏感词过滤正常

**技术实现:**
- Supabase Realtime
- PostGIS地理查询
- 本地消息缓存

#### 4.6.3 PTT呼叫
**功能描述:**
模拟真实对讲机的按键通话功能。

**需求细节:**
- 操作方式:长按发送,松开结束
- 语音录制:最长60秒
- 发送范围:根据设备等级
  - 收音机:无法发送(只能接收)
  - 对讲机:3公里
  - 营地电台:10公里
  - 卫星通讯:全球
- 播放:自动播放,有音频波形动画

**验收标准:**
- [ ] 长按交互流畅
- [ ] 语音录制质量清晰
- [ ] 范围限制准确
- [ ] 设备等级验证正确

#### 4.6.4 频道系统
**功能描述:**
类似群组的主题频道。

**需求细节:**
- 创建频道:
  - 频道名称(必填)
  - 频道描述(选填)
  - 是否公开
- 加入频道:
  - 搜索频道
  - 查看附近频道
  - 申请加入/直接加入
- 频道管理:
  - 创建者是管理员
  - 可以踢人/设置管理员
  - 可以解散频道

**验收标准:**
- [ ] 频道CRUD功能完整
- [ ] 权限控制准确
- [ ] 成员管理正常

### 4.7 社交系统

#### 4.7.1 排行榜
**功能描述:**
多维度排名系统。

**排行榜类型:**
1. 领地面积榜:总面积最大的玩家
2. 探索废墟榜:搜刮POI次数最多
3. 建筑数量榜:拥有建筑最多

**需求细节:**
- 榜单展示:
  - Top 100
  - 显示:排名、昵称、数值、头像
  - 自己的排名高亮
- 更新频率:每5分钟刷新
- 查看详情:点击可查看其他玩家档案(公开信息)

**验收标准:**
- [ ] 排名计算准确
- [ ] 数据缓存减少DB压力
- [ ] 自己排名正确显示
- [ ] 性能优秀(百万用户也能快速查询)

**技术实现:**
- 数据库窗口函数(RANK())
- Redis缓存
- 分页加载

#### 4.7.2 成就系统
**功能描述:**
任务和成就的引导系统。

**成就分类:**

**新手成就**
- 第一次登录 → 50金币
- 第一次圈地 → 100金币
- 第一次搜刮 → 100金币
- 第一次建造 → 150金币
- 第一次交易 → 200金币

**进阶成就**
- 领地达人:拥有5块领地 → 500金币
- 探索先锋:搜刮100个POI → 800金币
- 建造大师:建造50个建筑 → 1000金币

**稀有成就**
- 地产大亨:总领地面积超过100,000平方米 → 5000金币
- 废土行者:探索距离超过100公里 → 5000金币

**需求细节:**
- 成就检测:
  - 使用EventBus发布-订阅模式
  - 行为触发自动检测
- 成就奖励:
  - 金币自动发放
  - 称号解锁
- 成就展示:
  - 已完成/未完成状态
  - 进度条(如完成度40%)

**验收标准:**
- [ ] 成就触发准确
- [ ] 奖励正确发放
- [ ] 进度计算准确
- [ ] EventBus解耦良好

#### 4.7.3 生存体征
**功能描述:**
模拟真实生存需求的数值系统。

**体征指标:**
1. 核心生命:0-100,归零则死亡
2. 饱食度:0-100%,每小时-5
3. 水分:0-100%,每小时-10

**衰减规则:**
- 饱食度 < 50%:核心生命每小时-2
- 水分 < 50%:核心生命每小时-3
- 饱食度和水分 > 80%:获得增益(探索奖励+20%)

**恢复方式:**
- 使用食物:+30-50饱食度
- 使用水:+40-60水分
- 休息(在庇护所):核心生命每小时+5

**需求细节:**
- 实时计算:每10分钟检查一次
- 离线计算:登录时补算离线期间的衰减
- 死亡惩罚:
  - 损失背包中50%的物品(随机)
  - 重生在最近的领地
  - 24小时保护期(不再衰减)

**验收标准:**
- [ ] 衰减计算准确
- [ ] 离线补算正确
- [ ] 增益效果生效
- [ ] 死亡流程完整

**技术实现:**
- 定时器(Timer)
- 时间戳计算
- 状态持久化

### 4.8 商业化系统

#### 4.8.1 内购系统
**功能描述:**
基于StoreKit 2的应用内购买。

**商品类型:**

**订阅类(自动续费)**
| 商品名称 | 价格 | 周期 | 权益 |
|---------|------|------|------|
| 开拓者月卡 | $9.99 | 月 | 每日登录资源包、探索范围+50%、背包容量+50 |
| 领主通行证 | $19.99 | 月 | 月卡权益+所有建筑立即完成+交易手续费免除 |

**消耗类(一次性)**
| 商品名称 | 价格 | 内容 |
|---------|------|------|
| 初级物资包 | $0.99 | 食物×50, 水×50, 木材×100 |
| 中级物资包 | $2.99 | 食物×150, 水×150, 木材×300, 金属×100 |
| 高级物资包 | $4.99 | 全资源各×300 |
| 稀有资源包 | $9.99 | 电路板×50, 卫星模块×20 |

**需求细节:**
- 购买流程:
  1. 用户选择商品
  2. 调用StoreKit展示支付界面
  3. 用户完成支付
  4. 验证收据
  5. 发放商品
- 订阅管理:
  - 查看订阅状态
  - 取消续费(跳转App Store)
  - 恢复购买
- 家庭共享:支持(订阅类商品)

**验收标准:**
- [ ] 商品列表正确加载
- [ ] 购买流程完整
- [ ] 收据验证安全
- [ ] 商品发放准确
- [ ] 订阅状态同步
- [ ] 恢复购买正常

**技术实现:**
- StoreKit 2
- 服务端收据验证
- 购买记录持久化

#### 4.8.2 多语言支持
**功能描述:**
支持多语言切换,面向全球市场。

**支持语言:**
- 简体中文(zh-Hans)
- 繁体中文(zh-Hant)
- 英语(en)
- 日语(ja) - 未来
- 韩语(ko) - 未来

**需求细节:**
- 语言切换:设置页面选择,重启生效
- 翻译范围:
  - 所有UI文本
  - 游戏内物品名称和描述
  - 系统消息和通知
  - 成就和任务描述
- 本地化资源:
  - Localizable.strings
  - 图片文字(如需要)

**验收标准:**
- [ ] 所有文本正确翻译
- [ ] 切换后全局生效
- [ ] 翻译质量高(人工校对)
- [ ] 不同语言布局适配

---

## 5. 非功能需求

### 5.1 性能要求
- **响应时间:**
  - 界面切换 < 300ms
  - GPS定位更新 < 1s
  - 聊天消息到达 < 1s
  - API请求响应 < 2s
- **离线能力:**
  - 核心功能离线可用(查看背包、领地)
  - 网络恢复自动同步
- **资源占用:**
  - 内存占用 < 200MB
  - 电池消耗合理(GPS优化)
  - 流量消耗 < 10MB/小时(正常使用)

### 5.2 安全性要求
- **数据安全:**
  - 用户密码加密存储(由Supabase处理)
  - Token安全存储(Keychain)
  - 敏感操作二次确认
- **作弊防护:**
  - GPS轨迹验证(速度、间隔)
  - 交易双重验证
  - 异常行为检测
- **隐私保护:**
  - 位置数据仅用于游戏功能
  - 符合GDPR和CCPA
  - 用户可随时删除数据

### 5.3 兼容性要求
- **系统支持:** iOS 16.0+
- **设备支持:** iPhone(主要)、iPad(适配)
- **网络环境:** 3G/4G/5G/WiFi
- **离线降级:** 核心功能离线可用

### 5.4 可扩展性要求
- **用户规模:** 支持100万并发用户
- **数据规模:** 支持千万级数据查询
- **功能扩展:** 模块化架构,易于添加新功能
- **国际化:** 易于添加新语言

### 5.5 可维护性要求
- **代码质量:** 遵循Swift最佳实践
- **文档完善:** 代码注释、API文档、架构文档
- **日志监控:** 完善的日志系统,便于排查问题
- **版本管理:** Git规范,清晰的commit记录

---

## 6. 用户体验

### 6.1 视觉设计
**设计风格:** 希望朋克(Hopepunk)
- 色调:废土灰+新生绿
- 破败中透出希望
- 科技感+自然元素

**UI设计原则:**
- 扁平化设计,清晰易懂
- 大按钮,适合户外使用
- 高对比度,阳光下可读
- 动效流畅,提供反馈

### 6.2 交互设计
- **操作简单:** 核心操作一键完成
- **反馈及时:** 所有操作有视觉/听觉反馈
- **容错性强:** 重要操作有确认,可撤销
- **引导清晰:** 新手教程+成就引导

### 6.3 音效设计
- **环境音:** 末日氛围音效
- **交互音:** 按钮点击、消息提示
- **反馈音:** 获得奖励、任务完成
- **可选关闭:** 所有音效可独立关闭

---

## 7. 数据指标

### 7.1 核心指标
- **DAU(日活跃用户):** 目标10万(6个月)
- **留存率:**
  - 次日留存 > 40%
  - 7日留存 > 20%
  - 30日留存 > 10%
- **ARPU(平均每用户收入):** $2/月
- **付费率:** 5%

### 7.2 行为指标
- **日均圈地次数:** 1.5次/DAU
- **日均探索距离:** 2公里/DAU
- **日均消息数:** 5条/DAU
- **日均交易次数:** 0.3次/DAU

### 7.3 增长指标
- **K因子(病毒系数):** > 0.5
- **推荐转化率:** > 10%
- **社交分享率:** > 15%

---

## 8. 开发计划

### 8.1 里程碑

**Phase 1: MVP (4周)**
- Week 1-2: 用户系统 + 地图系统
- Week 3-4: 探索系统 + 背包系统
- **交付标准:** 可以登录、圈地、探索、收集资源

**Phase 2: 核心玩法 (4周)**
- Week 5-6: 建造系统 + 交易系统
- Week 7-8: 通讯系统(公共频道)
- **交付标准:** 完整的游戏循环

**Phase 3: 社交和商业化 (4周)**
- Week 9-10: 排行榜 + 成就系统
- Week 11-12: 内购系统 + 多语言
- **交付标准:** 可商业化运营

**Phase 4: 高级功能 (4周)**
- Week 13-14: 生存体征 + 高级通讯
- Week 15-16: 优化和测试
- **交付标准:** 正式上线

### 8.2 技术栈
- **前端:** SwiftUI (iOS 16+)
- **后端:** Supabase (Auth + Database + Realtime)
- **地图:** Apple MapKit
- **数据库:** PostgreSQL + PostGIS
- **支付:** StoreKit 2
- **存储:** SwiftData (本地) + Supabase (云端)
- **AI辅助:** Claude/Cursor

---

## 9. 风险与对策

### 9.1 技术风险
| 风险 | 影响 | 概率 | 对策 |
|------|------|------|------|
| GPS定位不准 | 圈地功能体验差 | 中 | 多重定位源,算法优化 |
| Supabase服务中断 | 游戏不可用 | 低 | 本地优先架构,离线降级 |
| 作弊行为泛滥 | 游戏公平性破坏 | 高 | 多重验证,异常检测,人工审核 |

### 9.2 运营风险
| 风险 | 影响 | 概率 | 对策 |
|------|------|------|------|
| 用户留存低 | 无法持续增长 | 中 | 数据分析,快速迭代,用户访谈 |
| 付费转化低 | 收入不达预期 | 中 | A/B测试,优化付费点设计 |
| 竞品冲击 | 用户流失 | 低 | 差异化定位,持续创新 |

### 9.3 合规风险
| 风险 | 影响 | 概率 | 对策 |
|------|------|------|------|
| 隐私政策不合规 | 应用下架 | 低 | 聘请法律顾问,严格遵守GDPR/CCPA |
| 内容审核不到位 | 用户投诉,监管介入 | 中 | 敏感词过滤,用户举报,人工审核 |

---

## 10. 成功标准

### 10.1 产品成功标准
- [ ] 6个月DAU达到10万
- [ ] 7日留存率 > 20%
- [ ] 月收入 > $20,000
- [ ] App Store评分 > 4.0
- [ ] 零重大安全事故

### 10.2 用户成功标准
- [ ] 新用户3分钟内完成第一次圈地
- [ ] 60%的新用户完成第一次探索
- [ ] 30%的活跃用户参与交易
- [ ] 用户NPS > 30

---

## 11. 附录

### 11.1 术语表
- **LBS:** Location Based Service,基于位置的服务
- **POI:** Point of Interest,兴趣点
- **PTT:** Push to Talk,按键通话
- **ARPU:** Average Revenue Per User,平均每用户收入
- **DAU:** Daily Active User,日活跃用户
- **NPS:** Net Promoter Score,净推荐值

### 11.2 参考资料
- 宝可梦GO玩法分析
- Ingress游戏机制研究
- 生存游戏资源系统设计
- Apple MapKit文档
- Supabase文档
- StoreKit 2最佳实践

---

**文档修订历史**

| 版本 | 日期 | 修订人 | 修订内容 |
|------|------|--------|----------|
| 1.0 | 2025-12-24 | AI Generated | 初始版本 |

---

**审批记录**

| 角色 | 姓名 | 审批意见 | 签名 | 日期 |
|------|------|----------|------|------|
| 产品负责人 | | | | |
| 技术负责人 | | | | |
| 设计负责人 | | | | |
